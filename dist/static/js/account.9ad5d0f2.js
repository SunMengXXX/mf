(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["account"],{"1a9f":function(e,a,n){"use strict";var t={userEmail:[{required:!0,message:"请输入邮箱"},{pattern:/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,message:"邮箱格式错误"}],userPhone:[{required:!0,message:"请输入手机号"},{pattern:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,message:"手机号格式错误"}],userPwd:[{required:!0,message:"请输入密码"},{pattern:/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[~!@&%#_])[a-zA-Z0-9~!@&%#_]{8,16}$/,message:"8到16位，包含大小写、数字、特殊字符"}],usercaptcha:[{required:!0,message:"请输入验证码"}]};a["a"]=t},"498a":function(e,a,n){"use strict";var t=n("23e7"),r=n("58a8").trim,s=n("c8d2");t({target:"String",proto:!0,forced:s("trim")},{trim:function(){return r(this)}})},5927:function(e,a,n){},"77be":function(e,a,n){"use strict";n.r(a);var t=n("7a23"),r={class:"account"},s=Object(t["i"])("注销账户"),l=Object(t["i"])("发送验证码"),c=Object(t["i"])("发送验证码");function i(e,a,n,i,u,o){var b=Object(t["G"])("Header"),p=Object(t["G"])("van-cell"),f=Object(t["G"])("van-button"),m=Object(t["G"])("van-field"),d=Object(t["G"])("van-cell-group"),h=Object(t["G"])("van-dialog");return Object(t["z"])(),Object(t["f"])("div",r,[Object(t["j"])(b,{title:"账户安全"}),Object(t["j"])(p,{title:"密码修改",onClick:a[1]||(a[1]=function(a){return e.passVisible=!0}),"is-link":""}),Object(t["j"])(p,{title:"邮箱绑定",onClick:a[2]||(a[2]=function(a){return e.emailVisible=!0}),"is-link":""}),Object(t["j"])(p,{title:"手机绑定",onClick:a[3]||(a[3]=function(a){return e.phoneVisible=!0}),"is-link":""}),Object(t["j"])(f,{class:"close",type:"primary",size:"large",onClick:i.close},{default:Object(t["P"])((function(){return[s]})),_:1},8,["onClick"]),Object(t["j"])(h,{class:"modal-pass",show:e.passVisible,"before-close":i.passBeforeClose,title:"修改密码","show-cancel-button":""},{default:Object(t["P"])((function(){return[Object(t["j"])(d,null,{default:Object(t["P"])((function(){return[Object(t["j"])(m,{modelValue:e.oldPass,"onUpdate:modelValue":a[4]||(a[4]=function(a){return e.oldPass=a}),label:"原密码",clearable:"",placeholder:"请输入原密码"},null,8,["modelValue"]),Object(t["j"])(m,{modelValue:e.newPass,"onUpdate:modelValue":a[5]||(a[5]=function(a){return e.newPass=a}),label:"新密码",clearable:"",placeholder:"请输入新密码"},null,8,["modelValue"]),Object(t["j"])(m,{modelValue:e.newPass2,"onUpdate:modelValue":a[6]||(a[6]=function(a){return e.newPass2=a}),label:"确认密码",clearable:"",placeholder:"再次输入确认"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["show","before-close"]),Object(t["j"])(h,{class:"modal-pass",show:e.emailVisible,"before-close":i.emailBeforeClose,title:"绑定邮箱","show-cancel-button":""},{default:Object(t["P"])((function(){return[Object(t["j"])(d,null,{default:Object(t["P"])((function(){return[Object(t["j"])(m,{modelValue:e.newEmail,"onUpdate:modelValue":a[7]||(a[7]=function(a){return e.newEmail=a}),label:"新邮箱",clearable:"",placeholder:"请输入要绑定的邮箱",rules:i.registerRules.userEmail,class:"cellBox"},null,8,["modelValue","rules"]),Object(t["j"])(m,{modelValue:e.captcha,"onUpdate:modelValue":a[8]||(a[8]=function(a){return e.captcha=a}),center:"",clearable:"",label:"验证码",placeholder:"输入验证码",rules:i.registerRules.usercaptcha,class:"cellBox"},{button:Object(t["P"])((function(){return[Object(t["j"])(f,{size:"small",type:"primary",onClick:e.sendCAPTCHA,disabled:e.emailDisabled},{default:Object(t["P"])((function(){return[l]})),_:1},8,["onClick","disabled"])]})),_:1},8,["modelValue","rules"])]})),_:1})]})),_:1},8,["show","before-close"]),Object(t["j"])(h,{class:"modal-pass",show:e.phoneVisible,"before-close":i.phoneBeforeClose,title:"绑定手机号","show-cancel-button":""},{default:Object(t["P"])((function(){return[Object(t["j"])(d,null,{default:Object(t["P"])((function(){return[Object(t["j"])(m,{modelValue:e.newPhone,"onUpdate:modelValue":a[9]||(a[9]=function(a){return e.newPhone=a}),label:"新手机号",clearable:"",placeholder:"请输入要绑定的手机号",rules:i.registerRules.userPhone,class:"cellBox"},null,8,["modelValue","rules"]),Object(t["j"])(m,{modelValue:e.captcha,"onUpdate:modelValue":a[10]||(a[10]=function(a){return e.captcha=a}),center:"",clearable:"",label:"验证码",placeholder:"输入验证码",rules:i.registerRules.usercaptcha,class:"cellBox"},{button:Object(t["P"])((function(){return[Object(t["j"])(f,{size:"small",type:"primary",onClick:e.sendCAPTCHA,disabled:e.phoneDisabled},{default:Object(t["P"])((function(){return[c]})),_:1},8,["onClick","disabled"])]})),_:1},8,["modelValue","rules"])]})),_:1})]})),_:1},8,["show","before-close"])])}n("b680"),n("498a");var u=n("5530"),o=(n("47e2"),n("2241")),b=(n("96cf"),n("1da1")),p=(n("433b"),n("d399")),f=n("6c02"),m=n("f0fc"),d=n("a27e"),h=n("1a9f");function w(e,a){var n=function(a){e.emailVisible?null===e.newEmail||""===e.newEmail||""===e.newEmail.trim()?p["a"].fail("邮箱不能为空！"):e.newEmail===e.email?p["a"].fail("新邮箱不能与原邮箱相同"):/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(e.newEmail)?t(a):p["a"].fail("邮箱格式不正确"):e.phoneVisible&&(null===e.newPhone||""===e.newPhone||""===e.newPhone.trim()?p["a"].fail("手机号不能为空"):e.newPhone===e.phone?p["a"].fail("新手机号不能\n与原手机号相同"):/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/.test(e.newPhone)?t(a):p["a"].fail("手机号格式不正确"))},t=function(){var a=Object(b["a"])(regeneratorRuntime.mark((function a(n){var t,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,!e.emailVisible){a.next=8;break}return a.next=4,d["a"].post("/HNBC/user/emailcaptcha",{email:e.newEmail});case 4:t=a.sent,"200"===t.state&&(p["a"].success(t.msg),e.emailDisabled=!0,j(n,e.emailDisabled)),a.next=13;break;case 8:if(!e.phoneVisible){a.next=13;break}return a.next=11,d["a"].post("/HNBC/user/phonecaptcha",{phone:e.newPhone});case 11:r=a.sent,"200"===r.state&&(p["a"].success(r.msg),e.phoneDisabled=!0,j(n,e.phoneDisabled));case 13:a.next=17;break;case 15:a.prev=15,a.t0=a["catch"](0);case 17:case"end":return a.stop()}}),a,null,[[0,15]])})));return function(e){return a.apply(this,arguments)}}();return{sendCAPTCHA:n,getCAPTCHA:t}}function j(e,a){var n=new Date((new Date).getTime()+61e3),t=setInterval((function(){var a=((n-(new Date).getTime())/1e3).toFixed(0);e.target.innerHTML="("+a+"s)",a<1&&(clearInterval(t),!1,e.target.innerHTML="发送验证码")}),1e3);return t}var O={name:"Account",components:{Header:m["a"]},setup:function(){var e=Object(f["d"])(),a=Object(t["D"])({passVisible:!1,oldPass:"",newPass:"",newPass2:"",emailVisible:!1,email:"",newEmail:"",phoneVisible:!1,phone:"",newPhone:"",captcha:"",emailDisabled:!1,phoneDisabled:!1}),n=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=17;break}return e.next=3,d["a"].post("/HNBC/user/bindemail",{email:a.newEmail,captcha:a.captcha});case 3:if(t=e.sent,"200"!==t.state){e.next=13;break}return p["a"].success(t.msg),a.newEmail="",a.captcha="",l(),a.passVisible=!1,e.abrupt("return",!0);case 13:return p["a"].fail(t.msg),e.abrupt("return",!1);case 15:e.next=21;break;case 17:return a.newEmail=a.email,a.captcha="",a.emailVisible=!1,e.abrupt("return",!0);case 21:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),r=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=17;break}return e.next=3,d["a"].post("/HNBC/user/bindphone",{phone:a.newPhone,captcha:a.captcha});case 3:if(t=e.sent,!t){e.next=13;break}return p["a"].success(t.msg),a.newPhone="",a.captcha="",l(),a.phoneVisible=!1,e.abrupt("return",!0);case 13:return p["a"].fail(t.msg),e.abrupt("return",!1);case 15:e.next=21;break;case 17:return a.newPhone=a.phone,a.captcha="",a.phoneVisible=!1,e.abrupt("return",!0);case 21:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),s=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(n){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("confirm"!==n){e.next=27;break}if(a.newPass==a.newPass2){e.next=6;break}return p["a"].fail("密码不一致"),e.abrupt("return",!1);case 6:if(a.newPass!==a.oldPass){e.next=11;break}return p["a"].fail("新密码不能与原密码相同"),e.abrupt("return",!1);case 11:if(!1!==/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[~!@&%#_])[a-zA-Z0-9~!@&%#_]{8,16}$/.test(a.newPass)){e.next=16;break}return p["a"].fail("密码必须包含大小写、数字、特殊字符，且在8到16位"),e.abrupt("return",!1);case 16:return e.next=18,d["a"].put("/HNBC/userinfo/updatepassword",{originalpassword:a.oldPass,newpassword:a.newPass});case 18:return t=e.sent,p["a"].success(t.msg),a.oldPass="",a.newPass="",a.newPass2="",a.passVisible=!1,e.abrupt("return",!0);case 25:e.next=32;break;case 27:return a.oldPass="",a.newPass="",a.newPass2="",a.passVisible=!1,e.abrupt("return",!0);case 32:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),l=function(){var e=Object(b["a"])(regeneratorRuntime.mark((function e(){var n,t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].get("/HNBC/user/getemailandphone");case 2:n=e.sent,t=n.data,a.email=t.email,a.phone=t.phone,a.newEmail=t.email,a.newPhone=t.phone;case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(t["w"])((function(){l()}));var c=function(){o["a"].confirm({title:"危险操作",message:"请您确认是否要注销账户\n(该操作不可逆)"}).then(Object(b["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,d["a"].delete("/HNBC/userinfo/deleteuser");case 2:n=a.sent,p["a"].success({message:n.msg+"\n即将跳转至登录页面",duration:1e3}),localStorage.clear(),setTimeout((function(){e.push({path:"/login"})}),1500);case 6:case"end":return a.stop()}}),a)})))).catch((function(){}))};return Object(u["a"])(Object(u["a"])(Object(u["a"])(Object(u["a"])({},Object(t["K"])(a)),w(a)),w(a)),{},{passBeforeClose:s,phoneBeforeClose:r,emailBeforeClose:n,close:c,getPhoneAndEmail:l,registerRules:h["a"]})}};n("cb18");O.render=i;a["default"]=O},c8d2:function(e,a,n){var t=n("d039"),r=n("5899"),s="​᠎";e.exports=function(e){return t((function(){return!!r[e]()||s[e]()!=s||r[e].name!==e}))}},cb18:function(e,a,n){"use strict";n("5927")}}]);